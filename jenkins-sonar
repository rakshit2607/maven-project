pipeline {
	agent any
	
	
	stages
	{
		stage ("scm checkout")
		{
git 'https://github.com/rakshit2607/maven-project.git'
		}
	}
   {
		stage ('Test stage'){
			steps {
				withMaven(maven: 'LocalMaven') 
					{
						sh 'mvn test'
					}
				}
			}
	}

	{
 	stage ('create package'){
			steps {
					withMaven(maven: 'LocalMaven') 
						{
							sh 'mvn package'
						}
					}
				}
	}
	{
   stage ('Install package'){
		steps {
			withMaven(maven: 'LocalMaven') 
				{
					sh 'mvn install'
				}
			}
		}
	}

	{
		stage ("Invoke Sonarqube validation")
		{
			steps
				{
					withSonarQubeEnv('sonar') 
					withMaven(maven: 'LocalMaven') 
						{
							sh 'clean install sonar:sonar'
						}
				}
		}
	}
}
